<div class="goals-container">
  <div class="goals-header">
    <h2>{{ 'financialGoals.title' | translate }}</h2>
    <button class="btn-add" (click)="openModal()">{{ 'financialGoals.addGoal' | translate }}</button>
  </div>

  <div class="content-wrapper">
    <div class="table-container">
      <h3>{{ 'financialGoals.financialGoals' | translate }}</h3>
      <table class="goals-table">
        <thead>
          <tr>
            <th>{{ 'financialGoals.table.goalName' | translate }}</th>
            <th>{{ 'financialGoals.table.targetAmount' | translate }}</th>
            <th>{{ 'financialGoals.table.date' | translate }}</th>
            <th>{{ 'financialGoals.table.progress' | translate }}</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let goal of goals">
            <td>{{ goal.goalName }}</td>
            <td>{{ formatAmount(goal.targetAmount) }}</td>
            <td>{{ formatDate(goal.createdAt) }}</td>
            <td>
              <div class="progress-container">
                <div class="progress-bar" 
                     [style.width.%]="goal.progress"
                     [attr.data-progress]="goal.progress.toFixed(1) + '%'">
                </div>
              </div>
            </td>
          </tr>
          <tr *ngIf="goals.length === 0">
            <td colspan="4" class="empty-state">
              {{ 'financialGoals.emptyState' | translate }}
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="goals-chart">
      <div class="target-line">
        <span class="target-label">{{ 'financialGoals.target100' | translate }}</span>
      </div>
      <div class="chart-bars">
        <div class="chart-bar" 
             *ngFor="let goal of goals.slice(0, 4)"
             [style.height.%]="goal.progress">
          <div class="bar-label">{{ goal.goalName }} {{ goal.progress.toFixed(1) }}%</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal para nueva meta financiera -->
<div class="modal" [class.show]="showModal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>{{ 'financialGoals.modal.title' | translate }}</h3>
      <button class="close-btn" (click)="closeModal()">{{ 'financialGoals.modal.close' | translate }}</button>
    </div>
    
    <form [formGroup]="goalForm" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label for="goalName">{{ 'financialGoals.modal.goalName' | translate }}</label>
        <input 
          type="text" 
          id="goalName" 
          formControlName="goalName" 
          [placeholder]="'financialGoals.modal.goalNamePlaceholder' | translate"
          required>
      </div>

      <div class="form-group">
        <label for="targetAmount">{{ 'financialGoals.modal.targetAmount' | translate }}</label>
        <input 
          type="number" 
          id="targetAmount" 
          formControlName="targetAmount" 
          [placeholder]="'financialGoals.modal.targetAmountPlaceholder' | translate"
          required>
      </div>

      <div class="form-group">
        <label for="months">{{ 'financialGoals.modal.duration' | translate }}</label>
        <input 
          type="number" 
          id="months" 
          formControlName="months" 
          [placeholder]="'financialGoals.modal.durationPlaceholder' | translate"
          required>
      </div>

      <div class="form-group">
        <label for="initialAmount">{{ 'financialGoals.modal.initialAmount' | translate }}</label>
        <input 
          type="number" 
          id="initialAmount" 
          formControlName="initialAmount" 
          [placeholder]="'financialGoals.modal.initialAmountPlaceholder' | translate">
      </div>

      <div class="form-group">
        <label for="priority">{{ 'financialGoals.modal.priority' | translate }}</label>
        <select id="priority" formControlName="priority" required>
          <option value="alta">{{ 'financialGoals.modal.high' | translate }}</option>
          <option value="media">{{ 'financialGoals.modal.medium' | translate }}</option>
          <option value="baja">{{ 'financialGoals.modal.low' | translate }}</option>
        </select>
      </div>

      <div class="form-group">
        <label for="description">{{ 'financialGoals.modal.description' | translate }}</label>
        <textarea 
          id="description" 
          formControlName="description" 
          [placeholder]="'financialGoals.modal.descriptionPlaceholder' | translate"
          rows="3">
        </textarea>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn-cancel" (click)="closeModal()">{{ 'financialGoals.modal.cancel' | translate }}</button>
        <button type="submit" class="btn-save" [disabled]="!goalForm.valid">{{ 'financialGoals.modal.save' | translate }}</button>
      </div>
    </form>
  </div>
</div>
